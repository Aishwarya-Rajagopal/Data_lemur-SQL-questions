"""
"""
Problem 1: https://datalemur.com/questions/sql-highest-grossing
with cte as(
SELECT category,product,sum(spend) as total_spend ,
rank() over(PARTITION by category order BY sum(spend) DESC ) as ranking
FROM product_spend
where EXTRACT(YEAR FROM transaction_date) = 2022
group by category,product
)
select category,product,total_spend
from cte
where ranking <3
order by category,ranking
;

Problem 2 :https://datalemur.com/questions/sql-second-highest-salary
SELECT salary
FROM employee
order by salary desc
limit 1 OFFSET 1;
